<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="description" content="××¤×œ×™×§×¦×™×™×ª × ×™×”×•×œ ×–××Ÿ ××‘×•×¡×¡×ª ××˜×¨×™×¦×ª ××™×™×–× ×”××•××¨" />
  <meta name="theme-color" content="#3B82F6" />
  
  <!-- ×× ×™×¢×ª caching - ×—×–×§ ×××•×“ -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate, max-age=0" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  <!-- ×× ×™×¢×ª Service Workers -->
  <meta name="mobile-web-app-capable" content="no" />
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="apple-touch-icon" href="/icon-192.png" />
  
  <!-- PWA Manifest - ×”×•×¡×¨ ×›×“×™ ×œ×× ×•×¢ Service Workers -->
  <!-- <link rel="manifest" href="/manifest.json" /> -->
  
  <!-- Apple Meta Tags -->
  <meta name="apple-mobile-web-app-title" content="××™×™×–× ×”××•××¨" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  
  <title>××˜×¨×™×¦×ª ××™×™×–× ×”××•××¨</title>
  
  <!-- ××—×™×§×ª Service Workers ×•-cache - ××•×§×“× ×××•×“, ×œ×¤× ×™ ×›×œ ×“×‘×¨ ××—×¨ -->
  <script>
    (function() {
      'use strict';
      console.log('ğŸš€ index.html script ×¨×¥ - ××•×§×“× ×××•×“!');
      
      // ××—×™×§×ª Service Workers - ××™×“
      if ('serviceWorker' in navigator) {
        console.log('ğŸ” ×‘×•×“×§ Service Workers...');
        
        // ×—×¡×™××ª register ×œ×¤× ×™ ×›×œ ×“×‘×¨ ××—×¨
        const originalRegister = navigator.serviceWorker.register;
        navigator.serviceWorker.register = function() {
          console.warn('ğŸš« × ×—×¡× × ×™×¡×™×•×Ÿ ×œ×¨×™×©×•× Service Worker');
          return Promise.reject(new Error('Service Workers disabled'));
        };
        
        // ××—×™×§×ª ×›×œ ×”-Service Workers ×”×§×™×™××™×
        navigator.serviceWorker.getRegistrations().then(function(registrations) {
          console.log('ğŸ“‹ × ××¦××•', registrations.length, 'Service Workers');
          registrations.forEach(function(reg) {
            reg.unregister().then(function() {
              console.log('âœ… Service Worker × ××—×§:', reg.scope);
            }).catch(function(err) {
              console.error('âŒ ×©×’×™××” ×‘××—×™×§×ª Service Worker:', err);
            });
          });
        }).catch(function(err) {
          console.error('âŒ ×©×’×™××” ×‘×§×‘×œ×ª Service Workers:', err);
        });
      } else {
        console.log('â„¹ï¸ ××™×Ÿ Service Worker support');
      }
      
      // ××—×™×§×ª cache - ××™×“
      if ('caches' in window) {
        caches.keys().then(function(cacheNames) {
          console.log('ğŸ“¦ × ××¦××•', cacheNames.length, 'caches');
          cacheNames.forEach(function(cacheName) {
            caches.delete(cacheName).then(function() {
              console.log('âœ… Cache × ××—×§:', cacheName);
            }).catch(function(err) {
              console.error('âŒ ×©×’×™××” ×‘××—×™×§×ª Cache:', err);
            });
          });
        }).catch(function(err) {
          console.error('âŒ ×©×’×™××” ×‘×§×‘×œ×ª Caches:', err);
        });
      } else {
        console.log('â„¹ï¸ ××™×Ÿ Cache API support');
      }
      
      // ×× ×™×¢×ª cache ×’× ×‘-fetch
      const originalFetch = window.fetch;
      window.fetch = function(...args) {
        const url = args[0];
        if (typeof url === 'string') {
          const isSupabaseRequest = url.includes('supabase.co') || url.includes('/rest/v1/') || url.includes('/auth/v1/');
          const isApiRequest = url.startsWith('http') && (url.includes('/api/') || url.includes('/rest/') || url.includes('/auth/'));
          
          if (!isSupabaseRequest && !isApiRequest && !url.startsWith('http')) {
            const separator = url.includes('?') ? '&' : '?';
            args[0] = url + separator + '_v=' + Date.now();
          }
        }
        return originalFetch.apply(this, args);
      };
      
      console.log('âœ¨ Service Workers ×•-Cache ××•×©×‘×ª×™× - ×¨×¢× ×•×Ÿ ×—×•×¤×©×™!');
    })();
  </script>
</head>
<body>
  <div id="root"></div>
  <script type="module" src="/src/main.jsx"></script>
</body>
</html>

